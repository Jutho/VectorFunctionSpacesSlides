<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jutho Haegeman">
<meta name="dcterms.date" content="2023-11-22">

<title>Vector- en functieruimten – Slides - Hoofdstuk 8 - Lineaire differentiaaloperatoren</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Vector- en functieruimten – Slides</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/H1.html" rel="" target="">
 <span class="menu-text">H1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/H2.html" rel="" target="">
 <span class="menu-text">H2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/H3.html" rel="" target="">
 <span class="menu-text">H3</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/H4.html" rel="" target="">
 <span class="menu-text">H4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/H5.html" rel="" target="">
 <span class="menu-text">H5</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/H6.html" rel="" target="">
 <span class="menu-text">H6</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#doel-van-dit-hoofdstuk" id="toc-doel-van-dit-hoofdstuk" class="nav-link active" data-scroll-target="#doel-van-dit-hoofdstuk">Doel van dit hoofdstuk</a></li>
  <li><a href="#differentiaaloperatoren-en-hun-toegevoegde" id="toc-differentiaaloperatoren-en-hun-toegevoegde" class="nav-link" data-scroll-target="#differentiaaloperatoren-en-hun-toegevoegde">Differentiaaloperatoren en hun toegevoegde</a>
  <ul class="collapse">
  <li><a href="#lineaire-differentiaalvergelijkingen" id="toc-lineaire-differentiaalvergelijkingen" class="nav-link" data-scroll-target="#lineaire-differentiaalvergelijkingen">Lineaire differentiaalvergelijkingen</a></li>
  <li><a href="#terugkerend-voorbeeld" id="toc-terugkerend-voorbeeld" class="nav-link" data-scroll-target="#terugkerend-voorbeeld">(Terugkerend) voorbeeld</a></li>
  <li><a href="#bijkomende-bemerkingen" id="toc-bijkomende-bemerkingen" class="nav-link" data-scroll-target="#bijkomende-bemerkingen">Bijkomende bemerkingen</a></li>
  <li><a href="#bijkomende-bemerkingen-1" id="toc-bijkomende-bemerkingen-1" class="nav-link" data-scroll-target="#bijkomende-bemerkingen-1">Bijkomende bemerkingen</a></li>
  <li><a href="#bijkomende-bemerkingen-2" id="toc-bijkomende-bemerkingen-2" class="nav-link" data-scroll-target="#bijkomende-bemerkingen-2">Bijkomende bemerkingen</a></li>
  <li><a href="#superpositie" id="toc-superpositie" class="nav-link" data-scroll-target="#superpositie">Superpositie</a></li>
  <li><a href="#superpositie-structuur-van-de-oplossingen" id="toc-superpositie-structuur-van-de-oplossingen" class="nav-link" data-scroll-target="#superpositie-structuur-van-de-oplossingen">Superpositie: structuur van de oplossingen</a></li>
  <li><a href="#existentie-en-uniciteit" id="toc-existentie-en-uniciteit" class="nav-link" data-scroll-target="#existentie-en-uniciteit">Existentie en uniciteit</a></li>
  <li><a href="#toegevoegde-operator" id="toc-toegevoegde-operator" class="nav-link" data-scroll-target="#toegevoegde-operator">Toegevoegde operator</a></li>
  <li><a href="#toegevoegde-operator-randvoorwaarden" id="toc-toegevoegde-operator-randvoorwaarden" class="nav-link" data-scroll-target="#toegevoegde-operator-randvoorwaarden">Toegevoegde operator: randvoorwaarden</a></li>
  <li><a href="#toegevoegde-operator-voorbeeld" id="toc-toegevoegde-operator-voorbeeld" class="nav-link" data-scroll-target="#toegevoegde-operator-voorbeeld">Toegevoegde operator: voorbeeld</a></li>
  <li><a href="#toegevoegde-operator-en-existentie-voorbeeld" id="toc-toegevoegde-operator-en-existentie-voorbeeld" class="nav-link" data-scroll-target="#toegevoegde-operator-en-existentie-voorbeeld">Toegevoegde operator en existentie: voorbeeld</a></li>
  <li><a href="#toegevoegde-operator-en-existentie-voorbeeld-1" id="toc-toegevoegde-operator-en-existentie-voorbeeld-1" class="nav-link" data-scroll-target="#toegevoegde-operator-en-existentie-voorbeeld-1">Toegevoegde operator en existentie: voorbeeld</a></li>
  <li><a href="#zelftoegevoegde-differentiaaloperatoren" id="toc-zelftoegevoegde-differentiaaloperatoren" class="nav-link" data-scroll-target="#zelftoegevoegde-differentiaaloperatoren">Zelftoegevoegde differentiaaloperatoren</a></li>
  <li><a href="#zelftoegevoegde-differentiaaloperatoren-1" id="toc-zelftoegevoegde-differentiaaloperatoren-1" class="nav-link" data-scroll-target="#zelftoegevoegde-differentiaaloperatoren-1">Zelftoegevoegde differentiaaloperatoren</a></li>
  <li><a href="#sturm-liouville-operator-randvoorwaarden" id="toc-sturm-liouville-operator-randvoorwaarden" class="nav-link" data-scroll-target="#sturm-liouville-operator-randvoorwaarden">Sturm-Liouville operator: randvoorwaarden</a></li>
  <li><a href="#sturm-liouville-operator-randvoorwaarden-1" id="toc-sturm-liouville-operator-randvoorwaarden-1" class="nav-link" data-scroll-target="#sturm-liouville-operator-randvoorwaarden-1">Sturm-Liouville operator: randvoorwaarden</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hoofdstuk 8 - Lineaire differentiaaloperatoren</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jutho Haegeman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="doel-van-dit-hoofdstuk" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="doel-van-dit-hoofdstuk">Doel van dit hoofdstuk</h2>
<div class="hidden">
<p>$$ % Math operators % % </p>
% VECTORS
<p>% specifically for vectors in F^n </p>
% MATRICES
<p>% SCALARS </p>
% LINEAR MAPS
<p>% FIELDS </p>
<p>% RELATIONS </p>
<p>% % % % % % % % %</p>
<p>%</p>
<p>$$</p>
</div>
<ul>
<li>Lineaire differentiaalvergelijkingen + randvoorwaarden
<ul>
<li>Beginvoorwaardeproblemen</li>
<li>Randvoorwaardeproblemen</li>
</ul></li>
<li>Algemene eigenschappen van differentiaaloperatoren en randvoorwaarden</li>
<li>Algemene structuur en eigenschappen van de oplossingen</li>
<li>Algemene oplossingsstrategieën</li>
<li>Eigenwaardeproblemen met differentiaaloperatoren</li>
</ul>
</section>
<section id="differentiaaloperatoren-en-hun-toegevoegde" class="level1">
<h1>Differentiaaloperatoren en hun toegevoegde</h1>
<section id="lineaire-differentiaalvergelijkingen" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="lineaire-differentiaalvergelijkingen">Lineaire differentiaalvergelijkingen</h2>
<ul>
<li><p>Lineaire differentiaalvergelijking:</p>
<p><span class="math display">\[({\hat{L}} u)(x) = f(x),\quad a &lt; x &lt; b\]</span></p>
<p>met (lineaire) differentiaaloperator</p>
<p><span class="math display">\[({\hat{L}}u)(x) = a_p(x) \frac{{\mathrm{d}}^p u}{{\mathrm{d}}x^p}(x) + a_{p-1}(x) \frac{{\mathrm{d}}^{p-1} u}{{\mathrm{d}}x^{p-1}}(x) + \ldots + a_1(x) \frac{{\mathrm{d}}u}{{\mathrm{d}}x}(x)+ a_0(x) u(x)\]</span></p></li>
<li><p>Randvoorwaarden: <span class="math inline">\(B_i[u] = \gamma_i, i=1,\ldots,m\)</span> met hierin</p>
<p><span class="math display">\[B_i[u] = \sum_{j=1}^{p} \alpha_{i,j} \frac{{\mathrm{d}}^{j-1} u}{{\mathrm{d}}x^{j-1}}(a) + \sum_{j=1}^{p} \alpha_{i,j+p} \frac{{\mathrm{d}}^{j-1} u}{{\mathrm{d}}x^{j-1}}(b)\]</span></p>
<ul>
<li>randvoorwaarden onafhankelijk als <span class="math inline">\({\mathsf{B}} = \begin{bmatrix} \alpha_{1,1} &amp;\dots &amp;\alpha_{1,2p}\\  \vdots &amp; &amp; \vdots\\  \alpha_{m,1} &amp;\dots &amp;\alpha_{m,2p}  \end{bmatrix}\)</span> rang <span class="math inline">\(m\)</span> heeft</li>
</ul></li>
</ul>
</section>
<section id="terugkerend-voorbeeld" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="terugkerend-voorbeeld">(Terugkerend) voorbeeld</h2>
<p><span class="math display">\[  -u''(x) = x\]</span></p>
<ul>
<li>zonder randvoorwaarden: <span class="math inline">\(u(x) = c_1 + c_2 x -\frac{1}{2} x^2\)</span></li>
<li>één randvoorwaarde:
<ul>
<li><span class="math inline">\(u(0)=0 \Rightarrow u(x) = c_2 x - \frac{1}{2} x^2\)</span></li>
<li><span class="math inline">\(u'(0) = 0 \Rightarrow u(x) = c_1 - \frac{1}{2} x^2\)</span></li>
</ul></li>
<li>twee randvoorwaarden:
<ul>
<li><span class="math inline">\(u(0) = u(1) = 0 \Rightarrow u(x) = -\frac{1}{2}x^2 +\frac{1}{2} x\)</span> (unieke oplossing)</li>
<li><span class="math inline">\(u'(0) = u'(1) = 0 \Rightarrow\)</span> geen oplossingen</li>
</ul></li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> hoe kunnen we het bestaan en de uniciteit van de oplossingen karakteriseren?</p>
</section>
<section id="bijkomende-bemerkingen" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bijkomende-bemerkingen">Bijkomende bemerkingen</h2>
<ol type="1">
<li><p>Met behulp van de positie en afleidingsoperator kunnen we <span class="math inline">\({\hat{L}}\)</span> schrijven als</p>
<p><span class="math display">\[{\hat{L}} = \sum_{j=0}^{p} a_j({\hat{X}}) {\hat{D}}^j\]</span></p></li>
<li><p>In de fysica: bijna steeds tweede-orde differentiaalvergelijkingen:</p>
<p><span class="math display">\[({\hat{L}}u)(x) = a_2(x) \frac{{\mathrm{d}}^2 u}{{\mathrm{d}}x^2}(x) + a_{1}(x) \frac{{\mathrm{d}}u}{{\mathrm{d}}x}(x) +  a_0(x) u(x)\]</span></p>
<ul>
<li>Voor meerdere bewijzen wordt enkel het <span class="math inline">\(p=2\)</span> geval aan bord gebracht, zelfs al doet de cursus algemene orde <span class="math inline">\(p\)</span>. Ook voor het examen is <span class="math inline">\(p=2\)</span> voldoende.</li>
</ul></li>
</ol>
</section>
<section id="bijkomende-bemerkingen-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bijkomende-bemerkingen-1">Bijkomende bemerkingen</h2>
<ol start="3" type="1">
<li><p>Waarde en regulariteit van de coefficiënten <span class="math inline">\(a_k(x)\)</span>?</p>
<ul>
<li><p>worden meestal reëel verondersteld <span class="math inline">\(\Rightarrow\)</span> ook oplossing <span class="math inline">\(u(x)\)</span> reëel</p>
<ul>
<li>zeker in wiskunde-literatuur</li>
<li>in kwantummechanica soms complexe coefficiënten nodig</li>
</ul></li>
<li><p>worden voldoende glad verondersteld:</p>
<ul>
<li>voor het definiëren van de toegevoegde operator (zie later) is <span class="math inline">\(a_k(x) \in C^k([a,b],{\mathbb{R}})\)</span> noodzakelijk</li>
</ul></li>
<li><p><span class="math inline">\(a_p(x) \neq 0\)</span> voor <span class="math inline">\(x\in [a,b]\)</span> of minstens <span class="math inline">\(x\in(a,b)\)</span></p></li>
</ul></li>
</ol>
</section>
<section id="bijkomende-bemerkingen-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bijkomende-bemerkingen-2">Bijkomende bemerkingen</h2>
<ol start="4" type="1">
<li><p>Domein van oplossingen = domein van <span class="math inline">\({\hat{L}}\)</span></p>
<ul>
<li><p>hoogste afgeleide <span class="math inline">\(u^{(p)}(x)\)</span> moet bestaan en kwadratisch integreerbaar zijn</p>
<p><span class="math inline">\(\Rightarrow u^{(p-1)}(x)\)</span> moet continu zijn</p>
<p><span class="math inline">\(\Rightarrow\)</span> minstens <span class="math inline">\(u(x) \in C^{(p-1)}([a,b])\)</span></p></li>
<li><p>technisch: <span class="math inline">\(p\)</span>de afgeleide kan in zwakke zin bestaan (zie H9)</p>
<p><span class="math inline">\(\rightarrow u \in H^p([a,b])\)</span> = Sobolevruimte</p></li>
<li><p>soms willen we ook de (homogene) randvoorwaarden opnemen in het domein van <span class="math inline">\({\hat{L}}\)</span></p></li>
</ul></li>
</ol>
</section>
<section id="superpositie" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="superpositie">Superpositie</h2>
<ul>
<li><p><strong>superpositie</strong> = belangrijkste eigenschap/gevolg van lineariteit</p>
<p><span class="math display">\[\begin{align*}
  {\hat{L}} u_1 &amp;= f_1 &amp;\text{met}&amp;&amp;B_i[ u_1 ] = \gamma_{1,i}, \forall i =1,\ldots,m\\
  {\hat{L}} u_2 &amp;= f_2 &amp;\text{met}&amp;&amp;B_i[ u_2 ] = \gamma_{2,i} \forall i =1,\ldots,m
\end{align*}\]</span></p>
<p><span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(u =a^1 u_1 + a^2 u_2\)</span> is de oplossing van <span class="math display">\[\begin{align*}
  {\hat{L}} u&amp;= a^1 f_1 + a^2 f_2 &amp;\text{met}&amp;&amp;B_i[ u ] = a^1 \gamma_{1,i} + a^2 \gamma_{2,i}, \forall i =1,\ldots,m
\end{align*}\]</span></p></li>
<li><p>Vergelijk met <span class="math inline">\({\mathsf{A}}\boldsymbol{x} = \boldsymbol{y}\)</span></p>
<ul>
<li>Rechterlid <span class="math inline">\(\boldsymbol{y}\)</span> correspondeert met zowel het rechterlid <span class="math inline">\(f\)</span> van de differentiaalvergelijking, als het rechterlid <span class="math inline">\(\gamma\)</span> van de randvoorwaarden</li>
<li>Uniciteit hangt samen met het bestaan van niet-triviale oplossingen van de homogene vergelijking</li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> (volledig) homogeen probleem = homogene differentiaalvergelijking met homogene randvoorwaarden</p>
<p><span class="math display">\[({\hat{L}} u)(x) = 0, \quad \forall a &lt; x &lt; b\qquad \text{with}\ B_i[u] = 0, \forall i=1,\ldots,m\]</span></p></li>
</ul>
</section>
<section id="superpositie-structuur-van-de-oplossingen" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="superpositie-structuur-van-de-oplossingen">Superpositie: structuur van de oplossingen</h2>
<ul>
<li><p>We ontbinden de oplossing van het algemene probleem als <span class="math inline">\(u = u_0 + u_f + u_\gamma\)</span>:</p>
<ul>
<li><p>een oplossing <span class="math inline">\(u_0\)</span> van het volledig homogene probleem:</p>
<p><span class="math display">\[({\hat{L}} u_0)(x) = 0, \quad \forall a &lt; x &lt; b\qquad \text{with}\ B_i[u_0] = 0, \forall i=1,\ldots,m\]</span></p>
<p><span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(u_0(x)=0\)</span> is steeds oplossing; indien andere oplossingen <span class="math inline">\(u_0\)</span> bestaan is de finale oplossing <span class="math inline">\(u\)</span> niet uniek</p></li>
<li><p>een particuliere oplossing <span class="math inline">\(u_f\)</span> van de inhomogene differentiaalvergelijking met homogene randvoorwaarden</p>
<p><span class="math display">\[({\hat{L}} u_f)(x) = f(x), \quad \forall a &lt; x &lt; b\qquad \text{with}\ B_i[u_f] = 0, \forall i=1,\ldots,m\]</span></p></li>
<li><p>een particuliere oplossing <span class="math inline">\(u_\gamma\)</span> van de homogene differentiaalvergelijknig met inhomogene randvoorwaarden</p>
<p><span class="math display">\[({\hat{L}} u_\gamma)(x) = 0, \quad \forall a &lt; x &lt; b\qquad \text{with}\ B_i[u_\gamma] = \gamma_i, \forall i=1,\ldots,m\]</span></p></li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> wanneer is het bestaan van <span class="math inline">\(u_f\)</span> en <span class="math inline">\(u_\gamma\)</span> gegarandeerd?</p></li>
</ul>
</section>
<section id="existentie-en-uniciteit" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="existentie-en-uniciteit">Existentie en uniciteit</h2>
<ul>
<li><p>Existentie van <span class="math inline">\(u_\gamma\)</span> is voor later</p></li>
<li><p>Voor <span class="math inline">\(u_0\)</span> en <span class="math inline">\(u_f\)</span> definiëren we de nu het domein van de differentiaaloperator als:</p>
<p><span class="math display">\[\mathop{\mathrm{\mathcal{D}}}\,\!_{{\hat{L}}} = \{ u \in L^2([a,b]) | u^{(p)}\ \text{bestaat en}\ u^{(p)} \in L^2([a,b])\ \text{en}\ B_i[u] = 0, \forall i=1,\ldots,m\}\]</span></p>
<ul>
<li>voor uniciteit: <span class="math inline">\(u_0 \in \mathop{\mathrm{ker}}({\hat{L}}) \Rightarrow \mathop{\mathrm{ker}}({\hat{L}}) = \{{o}\}\)</span>?</li>
<li>voor bestaan van <span class="math inline">\(u_f\)</span>: <span class="math inline">\(f \in \mathcal{R}_{{\hat{L}}} = \{{\hat{L}}u,\forall u \in \mathop{\mathrm{\mathcal{D}}}_{{\hat{L}}}\}\)</span>? <span class="math inline">\(\rightarrow\)</span> niet echt praktisch</li>
</ul></li>
<li><p>Voor begrensde operator <span class="math inline">\({\hat{A}}\)</span>: <span class="math inline">\(\mathcal{R}_{{\hat{A}}} = \mathop{\mathrm{im}}({\hat{A}})\)</span> voldoet aan <span class="math inline">\(\overline{\mathop{\mathrm{im}}({\hat{A}})} = \mathop{\mathrm{ker}}({\hat{A}}^\dagger)^\perp\)</span></p>
<ul>
<li><p><span class="math inline">\(f \in \overline{\mathop{\mathrm{im}}({\hat{A}})} \iff \forall w \in \mathop{\mathrm{ker}}({\hat{A}}^\dagger): {\left\langle w,f\right\rangle}=0\)</span></p></li>
<li><p><span class="math inline">\({\hat{L}}\)</span> is geen begrensde operator:</p>
<p><span class="math inline">\(\forall v \in \mathop{\mathrm{ker}}({\hat{A}}^\dagger): {\left\langle v,f\right\rangle}={\left\langle v,{\hat{L}}u\right\rangle}={\left\langle L^\dagger v,u\right\rangle} = 0\)</span>: noodzakelijk!</p></li>
<li><p>zonder bewijs: ook voldoende voorwaarde (gekend als “Fredholm alternative theorem”) voor zogenaamde Fredholm operatoren: omvat bepaalde klassen van differentiaaloperatoren</p></li>
</ul></li>
</ul>
</section>
<section id="toegevoegde-operator" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="toegevoegde-operator">Toegevoegde operator</h2>
<ul>
<li><p>We zijn geïnteresseerd in de kernel van de toegevoegde operator, i.e.</p>
<p><span class="math display">\[\begin{align}
  ({\hat{L}}^\dagger v)(x) = 0, \quad \forall a &lt; x &lt; b\qquad \text{met}\ v\in\mathop{\mathrm{\mathcal{D}}}\,\!_{{\hat{L}}^\dagger}\rightarrow\text{randvoorwaarden?}
\end{align}\]</span></p></li>
<li><p><strong>formeel toegevoegde operator</strong>:</p>
<p><span class="math display">\[{\hat{L}}^\dagger = \sum_{j=0}^{p} (-1)^{j} {\hat{D}}^j \overline{a_j}({\hat{X}})\implies     ({\hat{L}}^\dagger v)(x) = \sum_{j=0}^{p} (-1)^j \frac{{\mathrm{d}}^j\ }{{\mathrm{d}}x^j} (\overline{a_j(x)} v(x))\]</span></p>
<p>(met behulp van <span class="math inline">\({\hat{D}}^\dagger = -{\hat{D}}\)</span>)</p>
<ul>
<li>als <span class="math inline">\({\hat{L}}={\hat{L}}^\dagger\)</span>: <strong>formeel zelf-toegevoegd</strong></li>
</ul></li>
<li><p>identiteit van Lagrange: (bewijs aan bord)</p>
<p><span class="math display">\[\overline{v(x)} ({\hat{L}}u)(x) - \overline{({\hat{L}}^\dagger v)(x)}u(x) = \frac{{\mathrm{d}}\ }{{\mathrm{d}}x} J(u(x),v(x))\]</span></p>
<p>met hierin <span class="math inline">\(J(u(x),v(x)) = \sum_{j=0}^{p} \sum_{k=0}^{j-1} (-1)^k \left(\frac{{\mathrm{d}}^k\ }{{\mathrm{d}}x^k}[ a_j(x) \overline{v(x)}]\right)\left(\frac{{\mathrm{d}}^{j-1-k}\ }{{\mathrm{d}}x^{j-1-k}}u(x)\right)\)</span><br>
(bilineaire concomitant)</p></li>
</ul>
</section>
<section id="toegevoegde-operator-randvoorwaarden" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="toegevoegde-operator-randvoorwaarden">Toegevoegde operator: randvoorwaarden</h2>
<ul>
<li><p>De identiteit van Lagrange geïntegreerd over <span class="math inline">\([a,b]\)</span> = identiteit van Green:</p>
<p><span class="math display">\[{\left\langle v,{\hat{L}}u\right\rangle} - {\left\langle{\hat{L}}^\dagger v,u\right\rangle} =\left. J(u(x),v(x))\right|^b_a = \left. J(u(x),v(x))\right|_{x=b} - \left. J(u(x),v(x))\right|_{x=a}\]</span></p></li>
<li><p>Met behulp van <span class="math display">\[\begin{align}
  \boldsymbol{x} = \begin{bmatrix}u(a) &amp; u'(a) &amp; \dots &amp; u^{(p-1)}(a) &amp; u(b) &amp; u'(b) &amp; \dots &amp; u^{(p-1)}(b)\end{bmatrix}^{\mathsf{T}}\nonumber\\
  \boldsymbol{y} = \begin{bmatrix}v(a) &amp; v'(a) &amp; \dots &amp; v^{(p-1)}(a) &amp; v(b) &amp; v'(b) &amp; \dots &amp; v^{(p-1)}(b)\end{bmatrix}^{\mathsf{T}}
\end{align}\]</span></p>
<p><span class="math inline">\(\Rightarrow \left. J(u(x),v(x))\right|^b_a = \boldsymbol{y}^{\mathsf{H}}{\mathsf{P}} \boldsymbol{x}\)</span> met <span class="math inline">\({\mathsf{P}}\)</span> een <span class="math inline">\(2p \times 2p\)</span> matrix</p></li>
<li><p>Randvoorwaarden voor <span class="math inline">\({\hat{L}}\)</span>: <span class="math inline">\({\mathsf{B}} \boldsymbol{x} = \boldsymbol{0}\)</span> met <span class="math inline">\({\mathsf{B}}\)</span> een <span class="math inline">\(m \times 2p\)</span> matrix met volle rang (<span class="math inline">\(=m\)</span>)</p>
<ul>
<li><p>stel: <span class="math inline">\({\mathsf{K}}\)</span> een <span class="math inline">\(2p \times (2p-m)\)</span> matrix met kolommen een basis voor <span class="math inline">\(\mathop{\mathrm{ker}}({\mathsf{B}})\)</span></p>
<p><span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\((2p-m)\)</span> randvoorwaarden voor toegevoegde operator:</p>
<p><span class="math display">\[\boldsymbol{y}^{\mathsf{H}}{\mathsf{P}}{\mathsf{K}} = \boldsymbol{0}^{\mathsf{H}}\Leftrightarrow ({\mathsf{P}}{\mathsf{K}})^{\mathsf{H}}\boldsymbol{y} = \boldsymbol{0}\]</span></p></li>
</ul></li>
</ul>
</section>
<section id="toegevoegde-operator-voorbeeld" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="toegevoegde-operator-voorbeeld">Toegevoegde operator: voorbeeld</h2>
<ul>
<li><span class="math inline">\({\hat{L}}=-{\hat{D}}^2\)</span> op het interval <span class="math inline">\([0,1]\)</span>:
<ul>
<li>formeel toegevoegde: <span class="math inline">\({\hat{L}}^\dagger = -{\hat{D}}^2\)</span> (formeel zelftoegevoegd)</li>
<li>identiteit van Green: <span class="math display">\[\begin{align*}
  &amp;\int_0^1 \overline{v(x)} (-u''(x))\,{\mathrm{d}}x - \int_0^1 (-\overline{v''(x)}) u(x)\,{\mathrm{d}}x\\
  &amp;\quad= [-v(1) u'(1) + v(0) u'(0)] + [v'(1) u(1) - v'(0) u(0)].
\end{align*}\]</span></li>
<li>randvoorwaarden voor <span class="math inline">\({\hat{L}}\)</span> <span class="math inline">\(\rightarrow\)</span> randvoorwaarden voor <span class="math inline">\({\hat{L}}^\dagger\)</span>
<ul>
<li><p><span class="math inline">\(m=0\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(v(0)=v(1)=v'(0)=v'(1)=0\)</span> (<span class="math inline">\(2p-m = 4\)</span>)</p></li>
<li><p><span class="math inline">\(m=1\)</span>: <span class="math inline">\(u(0)=0\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(v(0)=v(1)=v'(1)=0\)</span> (<span class="math inline">\(2p-m=3\)</span>)</p></li>
<li><p><span class="math inline">\(m=2\)</span>: <span class="math inline">\(u'(0)=u'(1)=0\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(v'(0)=v'(1)=0\)</span> (<span class="math inline">\(2p-m=2\)</span>)</p>
<p><span class="math inline">\(\rightarrow\)</span> <span class="math inline">\({\hat{L}}\)</span> is zelftoegevoegd</p></li>
<li><p><span class="math inline">\(m=3\)</span>: <span class="math inline">\(u(0)=u'(0)=u'(1)\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(v'(1)=0\)</span> (<span class="math inline">\(2p-m=1\)</span>)</p>
<p><span class="math inline">\(\rightarrow\)</span> <span class="math inline">\({\hat{L}}\)</span> is symmetrisch maar niet zelftoegevoegd</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="toegevoegde-operator-en-existentie-voorbeeld" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="toegevoegde-operator-en-existentie-voorbeeld">Toegevoegde operator en existentie: voorbeeld</h2>
<p><span class="math display">\[-u''(x) = f(x)\]</span></p>
<ul>
<li>zonder randvoorwaarden: <span class="math inline">\(u(x) = c_1 + c_2 x + \int_0^x\,{\mathrm{d}}y\left[\int_0^y \,{\mathrm{d}}z f(z)\right]\)</span>
<ul>
<li><span class="math inline">\(\mathop{\mathrm{ker}}({\hat{L}})\)</span>: <span class="math inline">\(-u''(x)=0 \rightarrow \{u_0(x)=1, u_0(x)=x\}\)</span> <span class="math inline">\(\implies\)</span> 2 vrije paramaters</li>
<li><span class="math inline">\({\hat{L}}^\dagger\)</span> heeft vier randvoorwaarden: <span class="math inline">\(\mathop{\mathrm{ker}}{{\hat{L}}^\dagger} =\{{o}\}\)</span> <span class="math inline">\(\implies\)</span> existentie voor elke <span class="math inline">\(f\)</span></li>
</ul></li>
<li><span class="math inline">\(u(0) = u(1)=0\)</span>: <span class="math inline">\(c_1=0\)</span>, <span class="math inline">\(c_2 = -\int_0^1\,{\mathrm{d}}y\left[\int_0^y \,{\mathrm{d}}z f(z)\right]\)</span>
<ul>
<li><span class="math inline">\(\mathop{\mathrm{ker}}({\hat{L}}) = \{{o}\}\)</span> <span class="math inline">\(\implies\)</span> uniciteit</li>
<li><span class="math inline">\({\hat{L}}^\dagger\)</span> heeft randvoorwaarden <span class="math inline">\(v(0)=v(1)=0\)</span> (zelf-toegevoegd) <span class="math inline">\(\Rightarrow \mathop{\mathrm{ker}}({\hat{L}}^\dagger)=\{{o}\}\)</span> <span class="math inline">\(\implies\)</span> existentie voor elke <span class="math inline">\(f\)</span></li>
</ul></li>
<li><span class="math inline">\(u'(0) = u'(1)=0\)</span>: <span class="math inline">\(u'(0)=c_2 = 0\)</span> en <span class="math inline">\(u'(1) = c_2 + \int_0^1 \,{\mathrm{d}}z f(z)=0\)</span>
<ul>
<li><span class="math inline">\(\mathop{\mathrm{ker}}({\hat{L}}) = \{u_0(x)=1\}\)</span> <span class="math inline">\(\implies\)</span> 1 vrije parameter (<span class="math inline">\(c_1\)</span>)</li>
<li><span class="math inline">\({\hat{L}}^\dagger\)</span> heeft randvoorwaarden <span class="math inline">\(v'(0)=v'(1)=0\)</span> (zelf-toegevoegd) <span class="math inline">\(\Rightarrow \mathop{\mathrm{ker}}({\hat{L}}^\dagger)=\{v_0(x)=1\}\)</span> <span class="math inline">\(\implies\)</span> existentie enkel als <span class="math inline">\({\left\langle v_0,f\right\rangle}=0 = \int_0^1\,{\mathrm{d}}z f(z)\)</span></li>
</ul></li>
</ul>
</section>
<section id="toegevoegde-operator-en-existentie-voorbeeld-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="toegevoegde-operator-en-existentie-voorbeeld-1">Toegevoegde operator en existentie: voorbeeld</h2>
<p><span class="math display">\[-u''(x) = f(x)\]</span></p>
<ul>
<li><span class="math inline">\(u(0) = u'(0) =u'(1) = 0\)</span>: <span class="math inline">\(c_0=0\)</span>, <span class="math inline">\(c_2=0\)</span>, <span class="math inline">\(c_2 + \int_0^1 \,{\mathrm{d}}z f(z)=0\)</span>
<ul>
<li><span class="math inline">\(\mathop{\mathrm{ker}}({\hat{L}}) = \{{o}\}\)</span> <span class="math inline">\(\implies\)</span> uniciteit</li>
<li><span class="math inline">\({\hat{L}}^\dagger\)</span> heeft randvoorwaarden <span class="math inline">\(v'(1)=0\)</span> (zelf-toegevoegd) <span class="math inline">\(\Rightarrow \mathop{\mathrm{ker}}({\hat{L}}^\dagger)=\{v_0(x)=1\}\)</span> <span class="math inline">\(\implies\)</span> existentie enkel als <span class="math inline">\({\left\langle v_0,f\right\rangle}=0 = \int_0^1\,{\mathrm{d}}z f(z)\)</span></li>
</ul></li>
</ul>
<p>Algemene conclusies: voor een fysisch probleem willen graag dat de oplossing:</p>
<ul>
<li>bestaat voor een willekeurige bronterm: <span class="math inline">\(\mathop{\mathrm{ker}}({\hat{L}}^\dagger) = \{{o}\}\)</span></li>
<li>de oplossing uniek is: <span class="math inline">\(\mathop{\mathrm{ker}}({\hat{L}}) = \{{o}\}\)</span></li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> dit zullen we enkel kunnen bereiken met <span class="math inline">\(m = 2p-m = p\)</span> randvoorwaarden</p>
</section>
<section id="zelftoegevoegde-differentiaaloperatoren" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="zelftoegevoegde-differentiaaloperatoren">Zelftoegevoegde differentiaaloperatoren</h2>
<ul>
<li>Zelftoegevoegde operatoren hebben nuttige eigenschappen (vb spectrum)</li>
<li>Eindig-dimensionaal:
<ul>
<li><span class="math inline">\({\hat{A}} = {\hat{A}}^\dagger \implies {\mathsf{A}} = {\mathsf{A}}^{\mathsf{H}}\)</span> als orthonormale basis</li>
<li>meer algemeen: <span class="math inline">\({\mathsf{A}}^\dagger = {\mathsf{g}}^{-1} {\mathsf{A}}^{\mathsf{H}}{\mathsf{g}}\)</span> met <span class="math inline">\({\mathsf{g}}\)</span> inwendig product van de basisvectoren</li>
</ul></li>
<li>Voor een differentiaaloperator op <span class="math inline">\([a,b]\)</span>:
<ul>
<li>misschien niet (formeel) zelf-toegevoegd t.o.v. standaard inwendig product</li>
<li>maar wel ten opzichte van <span class="math inline">\({\left\langle v,u\right\rangle}_w\)</span>, dus voor functies <span class="math inline">\(u \in L^2_w([a,b])\)</span>
<ul>
<li><p>voor positie-operator: <span class="math inline">\({\left\langle v,{\hat{X}}u\right\rangle}_w = {\left\langle{\hat{X}}^\dagger v,u\right\rangle}_w\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(({\hat{X}}^\dagger v)(x) = x v(x) = ({\hat{X}} v)(x)\)</span></p>
<p>(altijd zelftoegevoegd)</p></li>
<li><p><span class="math inline">\({\left\langle v,{\hat{D}}u\right\rangle}_w = {\left\langle{\hat{D}}^\dagger v,u\right\rangle}_w\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(({\hat{D}}^\dagger v)(x) = -\frac{1}{w(x)} \frac{{\mathrm{d}}\ }{{\mathrm{d}}x} \left[w(x)v(x)\right]\)</span></p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="zelftoegevoegde-differentiaaloperatoren-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="zelftoegevoegde-differentiaaloperatoren-1">Zelftoegevoegde differentiaaloperatoren</h2>
<ul>
<li><p>Veralgemeende Lagrange-identiteit: <span class="math display">\[w(x) \overline{v(x)} ({\hat{L}}u)(x) - w(x) \overline{({\hat{L}}^\dagger v)(x)} u(x) = \frac{{\mathrm{d}}\ }{{\mathrm{d}}x} J(u(x),v(x))\]</span> met <span class="math inline">\(J(u(x),v(x)) = \sum_{j=0}^{p} \sum_{k=0}^{j-1} (-1)^k \left(\frac{{\mathrm{d}}^k\ }{{\mathrm{d}}x^k}[ w(x) a_j(x) \overline{v(x)}]\right)\left(\frac{{\mathrm{d}}^{j-1-k}\ }{{\mathrm{d}}x^{j-1-k}}u(x)\right)\)</span></p></li>
<li><p>Een reële 2de-orde differentiaaloperator is formeel zelf-toegevoegd t.o.v. <span class="math inline">\({\left\langle\ ,\ \right\rangle}_w\)</span> als en slechts als hij kan geschreven worden in de vorm van een <strong>Sturm-Liouville operator</strong>: (bewijs aan bord) <span class="math display">\[({\hat{L}}u)(x) = -\frac{1}{w(x)} \frac{{\mathrm{d}}\ }{{\mathrm{d}}x} \left( p(x) \frac{{\mathrm{d}}\ }{{\mathrm{d}}x} u (x)\right) + \frac{q(x)}{w(x)} u(x)\]</span></p></li>
<li><p>Er bestaat een keuze van <span class="math inline">\(w\)</span> die elke reële 2de-orde differentiaaloperator met <span class="math inline">\(a_2(x)\neq 0\)</span> voor <span class="math inline">\(x \in [a,b]\)</span> formeel zelf-toegevoegd maakt (bewijs aan bord)</p></li>
</ul>
</section>
<section id="sturm-liouville-operator-randvoorwaarden" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="sturm-liouville-operator-randvoorwaarden">Sturm-Liouville operator: randvoorwaarden</h2>
<ul>
<li><p>voor Sturm-Liouville operator <span class="math inline">\({\hat{L}}\)</span>: <span class="math inline">\(J(u(x),v(x)) = -p(x) \left[\overline{v(x)} u'(x) - \overline{v'(x)} u(x)\right]\)</span></p>
<p><span class="math display">\[\begin{align}
  \left[J(u(x),v(x))\right]_a^b &amp;= \boldsymbol{y}^{\mathsf{H}}{\mathsf{P}}\boldsymbol{x} =\begin{bmatrix}v(a)\\v'(a)\\v(b)\\v'(b)\end{bmatrix}^{\mathsf{H}}\begin{bmatrix} 0 &amp; +p(a) &amp; 0 &amp; 0 \\ -p(a) &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; -p(b) \\ 0 &amp; 0 &amp; +p(b) &amp; 0\end{bmatrix} \begin{bmatrix}u(a)\\u'(a)\\u(b)\\u'(b)\end{bmatrix}\label{eq:diff:boundarygeneralsturmliouville}\\
  &amp;= p(b) \det\left(\begin{bmatrix}
    u(b) &amp; \overline{v(b)} \\ u'(b) &amp; \overline{v'(b)}
  \end{bmatrix}\right) - p(a) \det\left(\begin{bmatrix}
    u(a) &amp; \overline{v(a)} \\ u'(a) &amp; \overline{v'(a)}
  \end{bmatrix}\right).
\end{align}\]</span></p></li>
<li><p>reguliere Sturm-Liouville operator: <span class="math inline">\(p(a)\neq 0\)</span>, <span class="math inline">\(p(b)\neq 0\)</span></p></li>
</ul>
</section>
<section id="sturm-liouville-operator-randvoorwaarden-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="sturm-liouville-operator-randvoorwaarden-1">Sturm-Liouville operator: randvoorwaarden</h2>
<p>Reguliere Sturm-Liouville operator is zelftoegevoegd voor:</p>
<ul>
<li><p>gescheiden randvoorwaarden: <span class="math display">\[\begin{align}
  {\mathsf{B}} \boldsymbol{x} = \begin{bmatrix}
    \alpha_{1} &amp; \alpha_{2} &amp; 0 &amp; 0\\
    0 &amp; 0 &amp; \beta_{1} &amp; \beta_{2}
  \end{bmatrix}\begin{bmatrix}u(a)\\u'(a)\\u(b)\\u'(b)\end{bmatrix} = \boldsymbol{0} \quad \iff\quad \begin{cases} \alpha_{1} u(a) + \alpha_{2} u'(a) = 0\\
  \beta_{1} u(b) + \beta_{2} u'(b) = 0\end{cases}.\label{eq:diff:seperatedbc}
\end{align}\]</span></p></li>
<li><p><span class="math inline">\(p(a) = p(b)\)</span> en periodieke randvoorwaarden: <span class="math display">\[\begin{align}
  {\mathsf{B}} \boldsymbol{x} = \begin{bmatrix}
    1 &amp; 0 &amp; -1 &amp; 0\\
    0 &amp; 1 &amp; 0 &amp; -1
  \end{bmatrix}\begin{bmatrix}u(a)\\u'(a)\\u(b)\\u'(b)\end{bmatrix} = \boldsymbol{0} \quad \iff\quad \begin{cases}  u(a) = u(b)\\
  u'(a) = u'(b)\end{cases}
\end{align}\]</span></p></li>
<li><p>andere oplossingen voor de randvoorwaarden, maar dit zijn de twee fysisch meest relevante gevallen</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>